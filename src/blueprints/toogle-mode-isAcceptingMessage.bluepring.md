POST REQUEST HANDLER BLUEPRINT

CHECK IF REQUEST METHOD IS POST

IF NOT, RETURN 405 METHOD NOT ALLOWED

GET SESSION USING getServerSession

IF SESSION OR session.user.\_id NOT FOUND, RETURN 401 SESSION NOT FOUND

PARSE REQUEST BODY

IF body.accm IS NOT BOOLEAN, RETURN 400 INVALID OR MISSING FLAG

GET USER BY ID FROM DATABASE

IF USER NOT FOUND, RETURN 404 USER NOT FOUND

CHECK IF USER.isAcceptingMessages IS ALREADY SAME AS FLAG

IF SAME, RETURN 400 ALREADY FLAGGED

UPDATE USER.isAcceptingMessages WITH NEW FLAG

RETURN 200 SUCCESS WITH UPDATED USER

CATCH ANY ERROR

RETURN 500 WITH ERROR MESSAGE
